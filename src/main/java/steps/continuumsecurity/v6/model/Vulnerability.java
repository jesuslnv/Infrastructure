package steps.continuumsecurity.v6.model;

import java.util.ArrayList;
import javax.xml.bind.annotation.XmlElement;

import steps.continuumsecurity.v5.model.Issue;
import com.fasterxml.jackson.annotation.JsonIgnoreProperties;

@JsonIgnoreProperties(ignoreUnknown = true)
public class Vulnerability {
    private int count;
    private String pluginName;
    private int severity;
    private int pluginId;

    public int getCount() {
        return count;
    }

    public void setCount(int count) {
        this.count = count;
    }

    @XmlElement(name = "plugin_name")
    public String getPluginName() {
        return pluginName;
    }

    public void setPluginName(String pluginName) {
        this.pluginName = pluginName;
    }

    public int getSeverity() {
        return severity;
    }

    public void setSeverity(int severity) {
        this.severity = severity;
    }

    @XmlElement(name = "plugin_id")
    public int getPluginId() {
        return pluginId;
    }

    public void setPluginId(int pluginId) {
        this.pluginId = pluginId;
    }

    public Issue toIssue(String nessusURl, String scanId) {
        Issue issue = new Issue(nessusURl, scanId);
        issue.setHostnames(new ArrayList<String>());
        issue.setHostsV6(new ArrayList<HostV6>());
        issue.setSeverity(severity);
        issue.setPluginName(pluginName);
        issue.setPluginID(pluginId);
        issue.setDescription(pluginName);
        return issue;
    }
}